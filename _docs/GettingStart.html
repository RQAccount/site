<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <meta name="format-detection" content="telephone=no,email=no" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge, chrome=1">
  <meta name="description" content="description of your site">
  <meta name="author" content="author of the site">
  <title>Bigview 开始</title>
  <link rel="stylesheet" href="source/main.css"/>
  
  
    
        <link rel="stylesheet" href="./style/a.css"/>
    
        <link rel="stylesheet" href="./style/b.css"/>
    
  
</head>
<body class=GettingStart >
    <div class="ydoc">
      <header class="ydoc-header">
        <div class="ydoc-header-area">
            
            <a href="http://ued.qunar.com/ymfe/" class="navbar-brand">YMFE</a>
            
            <button class="ydocIcon navbar-toggle">&#xf020;</button>
            <nav class="ydoc-nav">
              <ul class="navbar-left">
                
                    
                    <li class="">
                        
                        <a href="index.html">主页</a>
                        
                    </li>
                    
                    <li class="active">
                        
                        <a href="GettingStart.html">开始</a>
                        
                    </li>
                    
                    <li class="">
                        
                        <a href="Docs.html">文档</a>
                        
                    </li>
                    
                    <li class="">
                        
                        <a href="Api.html">Api</a>
                        
                    </li>
                    
                    <li class="">
                        
                        <a href="News.html">新闻</a>
                        
                    </li>
                    
                
              </ul>
            </nav>
        </div>
    </header>
    
    <!-- <header style="height:20px"></header> -->
    
      <!-- Docs page layout -->
      
      <div class="ydoc-banner-bg">
          <div class="ydoc-banner">
              <div class="ydoc-banner-area">
                  <h1>Bigview</h1>
                  <p>A fast, simple & powerful bigpipe framework</p>
              </div>
          </div>
      

      <div class="ydoc-container">
        
          
          <div class="ydoc-container-content">
              <div class="content-left" role="complementary">
                  <nav class="docs-sidebar hidden-print hidden-xs hidden-sm">
                    <ul class="nav docs-sidenav">
                        
                        
                        <!-- <li  > -->
                        <li >
                            
                            <a href="#开发过程概览">开发过程概览</a>
                            
                        </li>
                        
                        
                        
                        <!-- <li  > -->
                        <li >
                            
                            <a href="#安装bigview">安装bigview</a>
                            
                        </li>
                        
                        
                        
                        <!-- <li  > -->
                        <li >
                            
                            <a href="#路由定义">路由定义</a>
                            
                        </li>
                        
                        
                        
                        <!-- <li  > -->
                        <li >
                            
                            <a href="#创建bigview对象">创建bigview对象</a>
                            
                        </li>
                        
                        
                        
                        <!-- <li  > -->
                        <li >
                            
                            <a href="#创建模块">创建模块</a>
                            
                        </li>
                        
                        
                        
                        
                        <ul class="nav docs-sidenav-extend"  >
                        
                            <li >
                                <a href="#模块目录">模块目录</a>
                            </li>
                        
                        
                        
                        
                        
                            <li >
                                <a href="#index.js">index.js</a>
                            </li>
                        
                        
                        
                        
                        
                            <li >
                                <a href="#const.js">const.js</a>
                            </li>
                        
                        
                        
                        
                        
                            <li >
                                <a href="#parse.js">parse.js</a>
                            </li>
                        
                        
                        
                        
                        
                            <li >
                                <a href="#tpl/index.handlebars">tpl/index.handlebars</a>
                            </li>
                        
                        </ul>
                        
                        
                        
                        
                        <!-- <li  > -->
                        <li >
                            
                            <a href="#启动和部署">启动和部署</a>
                            
                        </li>
                        
                        
                    </ul>
                  </nav>
              </div>
              <div class="content-right markdown-body" role="main">

                
                <h2 id="开发过程概览">开发过程概览</h2><ol>
<li>编写静态页面</li>
<li>根据静态页面和功能切分模块，并决定采用的视图渲染模式</li>
<li>准备项目目录，并编写具体模块</li>
<li>QA+测试</li>
<li>部署</li>
</ol>
<p>了解开发过程，提前做好准备工作，避免项目里的反复，下面就跟着我一起开始bigview入门吧</p>
<h2 id="安装bigview">安装bigview</h2><pre><code class="lang-bash">$ <span class="token function">npm</span> i -S bigview
</code></pre>
<h2 id="路由定义">路由定义</h2><p>采用express的路由定义方式</p>
<pre><code class="lang-js">router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/some_url'</span><span class="token punctuation">,</span>
    <span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//检查权限</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../bpmodules/detail'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="创建bigview对象">创建bigview对象</h2><p>代码位于<code>/bpmodules/detail/index.js</code>，内容如下：</p>
<pre><code>&#39;use strict&#39;;

const BigView = require(&#39;bigview&#39;);

module.exports = function(req, res) {
    let bigview = new BigView(req, res,
        &#39;pages/detail/index&#39;, {
            title: &quot;国内机票-去哪儿网Qunar.com&quot;
        });

    bigview.add(require(&#39;./header&#39;));
    bigview.add(require(&#39;./menu&#39;));
    bigview.add(require(&#39;./zzz&#39;));
    bigview.add(require(&#39;./yyy&#39;));
    bigview.add(require(&#39;./xxx&#39;));
    bigview.add(require(&#39;./sidebar&#39;));
    bigview.add(require(&#39;./footer&#39;));

    bigview.addErrorPagelet(require(&#39;./error&#39;));

    bigview.start();
}
</code></pre><p>要点说明</p>
<ol>
<li>创建bigview对象，可以是BigView或者BigView子类的实例化对象</li>
<li>通过bigview.add方法增加模块</li>
<li>通过bigview.addErrorPagelet方法增加出错显示的模块</li>
<li>通过bigview.start()来开始渲染视图</li>
</ol>
<blockquote>
<p>说明：bigview支持5种渲染模式 pipeline | parallel | reduce | reducerender | render，默认是采用是性能最好的pipeline模式，如果需要可以通过bigview.mode来设置。</p>
</blockquote>
<h2 id="创建模块">创建模块</h2><p>安装脚手架</p>
<pre><code class="lang-bash">$ <span class="token function">npm</span> i -g bigview-cli
</code></pre>
<p>创建多个模块</p>
<pre><code class="lang-bash">$ bpm a b c
copy tpl /bigview_site/test/a/tpl
copy tpl /bigview_site/test/b/tpl
copy tpl /bigview_site/test/c/tpl
generate /bigview_site/test/a/const.js
generate /bigview_site/test/b/const.js
generate /bigview_site/test/c/const.js
generate /bigview_site/test/a/parse.js
generate /bigview_site/test/a/index.js
generate /bigview_site/test/b/index.js
generate /bigview_site/test/b/parse.js
generate /bigview_site/test/c/parse.js
generate /bigview_site/test/c/index.js
</code></pre>
<h3 id="模块目录">模块目录</h3><pre><code>$ tree bpmodules/detail/header 
bpmodules/detail/header
├── const.js
├── index.js
├── parse.js
└── tpl
    └── index.handlebars

1 directory, 4 files
</code></pre><p>说明</p>
<ul>
<li>index.js是入口，继承biglet</li>
<li>const.js用于定义常量</li>
<li>parse.js用于解析数据，用于etl数据处理（抽取、转换、加载、清洗）</li>
<li>tpl是防止模板的目录，默认biglet使用的是tpl/index</li>
</ul>
<h3 id="index.js">index.js</h3><pre><code>&#39;use strict&#39;

const Pagelet = require(&#39;biglet&#39;)

module.exports = class QPagelet extends Pagelet {
  constructor() {
    super()
    this.root = __dirname
    this.domid = &#39;a&#39;
  }

  fetch() {
    return Promise.resolve()
  }

  parse() {
      return Promise.resolve()
  }
}
</code></pre><h3 id="const.js">const.js</h3><pre><code>&#39;use strict&#39;;

module.exports = {
    &quot;changeStatus&quot; : {
        &#39;CHANGING&#39;: 40,
        &#39;CHANGE_DONE&#39;: 42
    }
};
</code></pre><h3 id="parse.js">parse.js</h3><pre><code>&#39;use strict&#39;;

const { changeStatus } = require(&#39;./const&#39;);
const { CHANGING, CHANGE_DONE} = changeStatus;

module.exports = function(pagelet) {
    let data = {
      a:1
    };

    return Promise.resolve(data);
};
</code></pre><h3 id="tpl/index.handlebars">tpl/index.handlebars</h3><pre><code>&lt;div class=&quot;m-warp m-line&quot;&gt;
    &lt;h1&gt; hello world &lt;/h1&gt;
&lt;/div&gt;
</code></pre><h2 id="启动和部署">启动和部署</h2><p>由于项目是express项目，只是view变成了bigview，所以启动和部署都和express一模一样。</p>

              </div>
          </div>
          
        
      </div>
     
     </div>
     
      <footer class="footer">
        <div class="copyright">
            &copy; 2016 <a href="http://ued.qunar.com/ymfe/">YMFE</a> Team. Build by <a href="http://ued.qunar.com/ydoc/">ydoc</a>.
        </div>
      </footer>
    </div>

    
       <div class="open-panel"></div>
    
    

    <script src="source/main.js"></script>
    <script src="source/app.js"></script>
    
    <script>
        var lineHeight = 17.4;
        var EXAMPLE_MAX_HEIGHT;
        function fold(){
            // 折叠code
            $('.markdown-body pre').css({"line-height": lineHeight+"px"});
            $('.markdown-body pre').map(function(i,item){
                var $item = $(item);
                var foldnumber = $item.data('foldnumber');
                EXAMPLE_MAX_HEIGHT = lineHeight * (foldnumber || 6);
                if($item.height() >EXAMPLE_MAX_HEIGHT){
                    $item.css({ "padding-bottom":30 });
                    $item.find('code').height(EXAMPLE_MAX_HEIGHT);
                    $item.append('<span class="extend">展开更多……</span>');
                };
            });
           $('.ydoc-example').delegate('.extend','click',function(){
                var $this = $(this);
                $this.removeClass('extend').addClass('fold');
                $this.html('折叠代码');
                $this.prev().height('auto');
                $this.prev().parent().height('auto');
            });
            $('.ydoc-example').delegate('.fold','click',function(){
                var $this = $(this);
                var foldnumber = $this.parent().data('foldnumber');
                EXAMPLE_MAX_HEIGHT = lineHeight * (foldnumber || 6);
                $this.removeClass('fold').addClass('extend');
                $this.parent().height(EXAMPLE_MAX_HEIGHT);  // pre
                $this.prev().height(EXAMPLE_MAX_HEIGHT);    // code
                $this.html("展开更多……");
            });
        }
        $(document).ready(fold);
    </script>
    
    
    <script>
    var DEFAULT_SHOW_PARAMS = 5;
    $(document).ready(function() {
        // 参数默认显示 5个
        $(".docs-table tbody").each(function(){
           var paramsLength = $(this).find('tr').length,
               paramsArray = $(this).find('tr'),
               curTbody = $(this).parents('.docs-table');

           if(paramsLength > DEFAULT_SHOW_PARAMS){
               curTbody.append('<span class="extend-params">展开更多参数……</span>');
               paramsArray.each(function(index,item){
                   if(index >= DEFAULT_SHOW_PARAMS ){
                       $(this).removeClass('hide-params').addClass('hide-params');
                   }
               });
           }
        });
        $(".docs-table").delegate('.extend-params', 'click',function(){
            $(this).parents('.docs-table').find('.hide-params').addClass('show-params');
            $(this).removeClass('extend-params').addClass('fold-params');
            $(this).html('折叠参数');
        });
        $('.docs-table').delegate('.fold-params','click',function(){
            $(this).removeClass('fold-params').addClass('extend-params');
             $(this).parents('.docs-table').find('.show-params').removeClass('show-params');
            $(this).html("展开更多参数……");
        });
    });
    </script>
    

    
    <script>
        $(document).ready(function(){
            var winWidth = $(window).width(),
                $navExtend = $('.docs-sidenav-extend'),
                $contentLeft = $('.content-left');

            changeHide();
            $(window).on('resize',function(){
                winWidth = $(window).width();
                changeHide();
            })
            function changeHide(){
                if(winWidth>767){
                    var activeInit = $contentLeft.find('.active');
                    $navExtend.hide();
                    $(window).on('scroll',function(){
                        var activeChange = $contentLeft.find('.active');
                        if(activeChange[0] && activeInit !== activeChange){
                            activeInit = activeChange;
                            $navExtend.hide();
                            if(activeChange.parent()[0].tagName === 'UL'){
                                if(activeChange.next()[0] && activeChange.parent()[0].className === 'nav docs-sidenav' && activeChange.next()[0].tagName === 'UL'){
                                    activeChange.next().show();
                                }else if (activeChange.parent()[0].className === 'nav docs-sidenav-extend') {
                                    activeChange.parent().show();
                                }
                            }
                        }
                    })
                }
            }
        })
    </script>
    

    
    
      
      <script type="text/javascript" src="./scripts/a.js"></script>
      
    

</body>
</html>
